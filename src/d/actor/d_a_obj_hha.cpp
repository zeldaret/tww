//
// Generated by dtk
// Translation Unit: d_a_obj_hha.cpp
//

#include "d/actor/d_a_obj_hha.h"
#include "JSystem/J3DGraphAnimator/J3DModelData.h"
#include "JSystem/JUtility/JUTAssert.h"
#include "SSystem/SComponent/c_bg_w.h"
#include "SSystem/SComponent/c_xyz.h"
#include "d/d_bg_w.h"
#include "d/d_com_inf_game.h"
#include "d/d_procname.h"
#include "d/res/res_hha.h"
#include "m_Do/m_Do_ext.h"
#include "m_Do/m_Do_mtx.h"

/* 00000078-00000170       .text init_data__14daObjHhaPart_cFffUsUcUc */
void daObjHhaPart_c::init_data(float param1, float param2, u16 param3, u8 param4, u8 param5) {
    m08.set(0, param1, 0);
    m14.set(0, param2, 0);
    u30 = param4;
    f2C = (param2 - param1) / param3;
    m20 = m14 - m08;
    m20.normalizeRS();
    m34.i0 = 0;
    m34.i4 = -1;
    m34.m8 = &daObjHhaPart_c::exe_normal;
    m40.i0 = 0;
    m40.i4 = -1;
    m40.m8 = &daObjHhaPart_c::draw_normal;
    u31 = param5;
}

/* 00000170-00000224       .text set_mdl_area__14daObjHhaPart_cFPCci */
bool daObjHhaPart_c::set_mdl_area(const char* arcname, int index) {
    J3DModelData* mdl_data = static_cast<J3DModelData*>(dComIfG_getObjectRes(arcname, index));
    JUT_ASSERT(0x1d9, mdl_data != 0);
    if(mdl_data != NULL){
        mpModel = mDoExt_J3DModel__create(mdl_data, 0, 0x11020203); 
    }

    return (mdl_data != NULL);
}

/* 00000224-000002A4       .text set_bgw__14daObjHhaPart_cFPCci */
bool daObjHhaPart_c::set_bgw(const char* arcname, int index) {
    mpBgw = dBgW_NewSet(
        static_cast<cBgD_t*>(dComIfG_getObjectRes(arcname, index)), 
        1,
        &mpModel->getBaseTRMtx()
    );

    return (mpBgw != NULL);
}

/* 000002A4-0000035C       .text init_mtx__14daObjHhaPart_cF4cXyz5csXyz4cXyz */
void daObjHhaPart_c::init_mtx(cXyz currentPos, csXyz shapeAngle, cXyz scale) {
    mpModel->setBaseScale(scale);
    mDoMtx_stack_c::transS(currentPos);
    mDoMtx_stack_c::ZXYrotM(shapeAngle);
    mDoMtx_stack_c::transM(m08);
    mpModel->setBaseTRMtx(mDoMtx_stack_c::now);
    mpModel->calc();
}

/* 0000035C-0000040C       .text exe_normal__14daObjHhaPart_cFP10daObjHha_c */
void daObjHhaPart_c::exe_normal(daObjHha_c* parent) {
    init_mtx(parent->current.pos, parent->shape_angle, parent->scale);

    bool doMove;
    if(this->mpBgw != NULL){
        if(0 <= this->mpBgw->GetId() && this->mpBgw->GetId() < 0x100){
            doMove = true;
        }
        else {
            doMove = false;
        }

        if(doMove){
            this->mpBgw->Move();
        }
    }

}

/* 0000040C-00000524       .text exe_move__14daObjHhaPart_cFP10daObjHha_c */
void daObjHhaPart_c::exe_move(daObjHha_c*) {
    /* Nonmatching */
}

/* 00000524-0000056C       .text draw_normal__14daObjHhaPart_cFP10daObjHha_c */
void daObjHhaPart_c::draw_normal(daObjHha_c* parent) {
    dKy_getEnvlight().setLightTevColorType(mpModel, &parent->tevStr);
    mDoExt_modelUpdateDL(this->mpModel);
}

/* 0000056C-00000698       .text create_s__16daObjHhaSplash_cFUsP4cXyzffP5csXyz */
void daObjHhaSplash_c::create_s(unsigned short param1, cXyz param2, float param3, float param4, csXyz param5) {
    cXyz acStack38;

    m20.set(param2.x, param2.y + param3, param2.z);
    mDoMtx_stack_c::YrotS(param5.y);
    mDoMtx_stack_c::multVec(&cXyz::BaseZ, &acStack38);
    acStack38 *= param4;
    m20 += acStack38;
    m14 = m20;
    m2C = param5;
    dComIfGp_particle_set(param1, &m20, &m2C, NULL, 0xff, this);
    b32 = true;
}

/* 00000698-000008AC       .text create_area__15daObjHhaYgush_cFPCc */
bool daObjHhaYgush_c::create_area(const char* arcname) {
    bool retval = false;

    J3DModelData* mdl_data = static_cast<J3DModelData*>(dComIfG_getObjectRes(arcname, HHA_BDL_YGSTP00));
    JUT_ASSERT(0x280, mdl_data != 0);
    
    if(mdl_data != NULL){
        mpModel = mDoExt_J3DModel__create(mdl_data, 0x80000, 0x11000222);
        JUT_ASSERT(0x289, mpModel != 0);

        if((mpModel != 0)){
            J3DAnmTextureSRTKey* btk_data = static_cast<J3DAnmTextureSRTKey*>(dComIfG_getObjectRes(arcname, HHA_BTK_YGSTP00));
            JUT_ASSERT(0x290, btk_data != 0);
            
            if(mBtk.init(mpModel->getModelData(), btk_data, true, J3DFrameCtrl::LOOP_REPEAT_e, 1.0, 0, -1, false, 0) != false){  
                J3DAnmTransform* bck_data = static_cast<J3DAnmTransform*>(dComIfG_getObjectRes(arcname, HHA_BCK_YGSTP00));
                JUT_ASSERT(0x295, bck_data != 0);
                
                if(mBck.init(mpModel->getModelData(), bck_data, true, J3DFrameCtrl::LOOP_REPEAT_e, 1.0, 0, -1, false) != false){
                    retval = true;
                }
            }
        }
    }

    return retval;
}

/* 000008AC-00000AD8       .text init_data__15daObjHhaYgush_cFP4cXyzfP5csXyzP4cXyzP12dKy_tevstr_cUc */
void daObjHhaYgush_c::init_data(cXyz param1, f32 param2, csXyz param3, cXyz param4, dKy_tevstr_c param5, u8 param6) {
    cXyz cStack3C;
    mDoMtx_stack_c::YrotS(param3.y);
    mDoMtx_stack_c::multVec(&cXyz::BaseZ, &cStack3C);
    cStack3C *= param2;
    mD8 = param1 + cStack3C;
    mTrans = mD8;
    mRot = param3;
    mScale = param4;
    mTev = param5;
    bVisible = param6;
}

/* 00000AD8-00000B88       .text init_mtx__15daObjHhaYgush_cFv */
void daObjHhaYgush_c::init_mtx() {
    J3DModel* pModel = mpModel;
    if(pModel != NULL){
        pModel->setBaseScale(mScale);
        mDoMtx_stack_c::transS(mTrans);
        mDoMtx_stack_c::ZXYrotM(mRot);
        mDoMtx_stack_c::scaleM(13.0f, 1.0f, 11.0f);
        mpModel->setBaseTRMtx(mDoMtx_stack_c::now);
    }
}

/* 00000B88-00000C2C       .text draw__15daObjHhaYgush_cFv */
BOOL daObjHhaYgush_c::draw() {
    if(bVisible != false && mpModel != NULL){
        dKy_getEnvlight().settingTevStruct(TEV_TYPE_BG1, &mTrans, &mTev);
        dKy_getEnvlight().setLightTevColorType(mpModel, &mTev);
        mBtk.entry(mpModel->getModelData());
        mBck.entry(mpModel->getModelData());
        mDoExt_modelUpdateDL(mpModel);
    }
}

/* 00000C2C-00000C4C       .text solidHeapCB__10daObjHha_cFP10fopAc_ac_c */
void daObjHha_c::solidHeapCB(fopAc_ac_c*) {
    /* Nonmatching */
}

/* 00000C4C-00000E48       .text create_heap__10daObjHha_cFv */
void daObjHha_c::create_heap() {
    /* Nonmatching */
}

/* 00000E48-000011AC       .text _create__10daObjHha_cFv */
s32 daObjHha_c::_create() {
    /* Nonmatching */
}

/* 000018EC-000019EC       .text _delete__10daObjHha_cFv */
BOOL daObjHha_c::_delete() {
    /* Nonmatching */
}

/* 000019EC-00001A24       .text check_sw__10daObjHha_cFv */
void daObjHha_c::check_sw() {
    /* Nonmatching */
}

/* 00001A24-00001A40       .text set_tex__10daObjHha_cFffi */
void daObjHha_c::set_tex(float, float, int) {
    /* Nonmatching */
}

/* 00001A40-00001B00       .text init_mtx__10daObjHha_cFv */
void daObjHha_c::init_mtx() {
    /* Nonmatching */
}

/* 00001B00-00001C64       .text init_co__10daObjHha_cFv */
void daObjHha_c::init_co() {
    /* Nonmatching */
}

/* 00001C64-00001E14       .text get_water_h__10daObjHha_cFv */
void daObjHha_c::get_water_h() {
    /* Nonmatching */
}

/* 00001F38-00001F68       .text set_splash_bottom_h__10daObjHha_cFv */
void daObjHha_c::set_splash_bottom_h() {
    /* Nonmatching */
}

/* 00001F68-0000201C       .text daObjHha_get_r__Fs */
void daObjHha_get_r(short) {
    /* Nonmatching */
}

/* 0000201C-000020C0       .text set_splash_bottom_r__10daObjHha_cFv */
void daObjHha_c::set_splash_bottom_r() {
    /* Nonmatching */
}

/* 000020C0-000021CC       .text set_splash_bottom_stop_r__10daObjHha_cFv */
void daObjHha_c::set_splash_bottom_stop_r() {
    /* Nonmatching */
}

/* 000021CC-00002470       .text water_manager__10daObjHha_cFv */
void daObjHha_c::water_manager() {
    /* Nonmatching */
}

/* 00002470-0000259C       .text part_manager__10daObjHha_cFv */
void daObjHha_c::part_manager() {
    /* Nonmatching */
}

/* 0000259C-00002658       .text ygush_manager__10daObjHha_cFv */
void daObjHha_c::ygush_manager() {
    /* Nonmatching */
}

/* 00002658-000028E4       .text _execute__10daObjHha_cFv */
BOOL daObjHha_c::_execute() {
    /* Nonmatching */
}

/* 000028E4-000029F4       .text _draw__10daObjHha_cFv */
BOOL daObjHha_c::_draw() {
    /* Nonmatching */
}

namespace {
/* 000029F4-00002A14       .text Mthd_Create__25@unnamed@d_a_obj_hha_cpp@FPv */
void Mthd_Create(void*) {
    /* Nonmatching */
}

/* 00002A14-00002A38       .text Mthd_Delete__25@unnamed@d_a_obj_hha_cpp@FPv */
void Mthd_Delete(void*) {
    /* Nonmatching */
}

/* 00002A38-00002A5C       .text Mthd_Execute__25@unnamed@d_a_obj_hha_cpp@FPv */
void Mthd_Execute(void*) {
    /* Nonmatching */
}

/* 00002A5C-00002A80       .text Mthd_Draw__25@unnamed@d_a_obj_hha_cpp@FPv */
void Mthd_Draw(void*) {
    /* Nonmatching */
}

/* 00002A80-00002A88       .text Mthd_IsDelete__25@unnamed@d_a_obj_hha_cpp@FPv */
void Mthd_IsDelete(void*) {
    /* Nonmatching */
}

static actor_method_class Hha_Mthd_Table = {
    (process_method_func)Mthd_Create,
    (process_method_func)Mthd_Delete,
    (process_method_func)Mthd_Execute,
    (process_method_func)Mthd_IsDelete,
    (process_method_func)Mthd_Draw,
};
}; // namespace

actor_process_profile_definition g_profile_Obj_Hha = {
    /* LayerID      */ fpcLy_CURRENT_e,
    /* ListID       */ 0x0003,
    /* ListPrio     */ fpcPi_CURRENT_e,
    /* ProcName     */ PROC_Obj_Hha,
    /* Proc SubMtd  */ &g_fpcLf_Method.base,
    /* Size         */ sizeof(daObjHha_c),
    /* SizeOther    */ 0,
    /* Parameters   */ 0,
    /* Leaf SubMtd  */ &g_fopAc_Method.base,
    /* Priority     */ 0x0049,
    /* Actor SubMtd */ &Hha_Mthd_Table,
    /* Status       */ fopAcStts_CULL_e | fopAcStts_UNK40000_e,
    /* Group        */ fopAc_ACTOR_e,
    /* CullType     */ fopAc_CULLBOX_CUSTOM_e,
};
